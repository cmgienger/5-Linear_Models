#C.M. Gienger
#regression and ANOVA examples

library(dplyr)
library(ggplot2)
library(ggfortify)

plant_gr <- read.csv("plant.growth.rate.csv")
glimpse(plant_gr)

#as always, make a plot first
ggplot(plant_gr,
       aes(x = soil.moisture.content, y = plant.growth.rate)) +
  geom_point() +
  ylab("Plant Growth Rate (mm/week)") +
  theme_bw()

#fit the model; notice y variable define first, "as function of..."
model_pgr <- lm(plant.growth.rate ~ soil.moisture.content,
                data = plant_gr)

#check the assumptions
autoplot(model_pgr, smooth.colour = NA)

#interpret the model
anova(model_pgr) #does not perform ANOVA
summary(model_pgr)

#add model prediction from coefficients (fit line) to the graph 
ggplot(plant_gr, aes(x = soil.moisture.content,
                     y = plant.growth.rate)) +
  geom_point() +
  geom_smooth(method = 'lm') +
  ylab("Plant Growth Rate (mm/week)") +
  theme_bw()
